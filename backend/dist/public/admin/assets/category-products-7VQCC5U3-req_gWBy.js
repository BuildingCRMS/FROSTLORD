import{u as z,a as I}from"./chunk-PCFUZKDS-kK7Bx7em.js";import{R as A,aN as B,j as t,b as x,r as b,a8 as H,e as M,aO as N,t as h,z as D,B as f,V as O,ab as V,a2 as K,ad as L,a4 as q}from"./index-C-aqpPpW.js";import{u as G,_ as Q}from"./chunk-B2JT2FOA-D-TfFkrL.js";import"./lodash-CaNp2Tn5.js";import{u as U}from"./chunk-RRZ6HVRV-Brfk1T7o.js";import"./chunk-GJUPECDU-D4jHO8Eu.js";import{K as X}from"./chunk-6HTZNHPT-CgFEWPk_.js";import{R as l,u as Z}from"./chunk-4TC5YS65-CUs0cNRB.js";import{c as $}from"./index-Dk3u0-aQ.js";import{C as y}from"./checkbox-BI-NcABA.js";import"./chunk-IQBAUTU5-UA-T0GCI.js";import"./chunk-ADOCJB6L-DEGlVDKs.js";import"./chunk-P3UUX2T6-D5QCb5jW.js";import"./chunk-C76H5USB-CapUlioK.js";import"./chunk-YEDAFXMB-Cry741uD.js";import"./chunk-AOFGTNG6-DpohskHP.js";import"./table-C-dNIP3m.js";import"./chunk-EMIHDNB7-CF7Wbal1.js";import"./plus-mini-DiXGmMQk.js";import"./command-bar-yphaa9qd.js";import"./index-ZwSr6h3z.js";import"./chunk-PFKKVLZX-WvaqRDsG.js";import"./format-DnoVlkiH.js";import"./_isIndex-Dg13dToS.js";import"./x-mark-mini-BfhzaRzl.js";import"./index-UFUZ2mUF.js";import"./date-picker-B5a0JSXg.js";import"./popover-D2Y_kR6I.js";import"./triangle-left-mini-D_svZAcQ.js";import"./prompt-Cl5xfF6Y.js";var J=K({product_ids:L(q())}),u=50,m="p",W=({categoryId:c,products:o=[]})=>{const{t:e}=x(),{handleSuccess:a}=Z(),[d,n]=b.useState(o.reduce((r,i)=>(r[i.id]=!0,r),{})),s=H({defaultValues:{product_ids:[]},resolver:V(J)}),P=r=>{const i=typeof r=="function"?r(d):r;s.setValue("product_ids",Object.keys(i),{shouldDirty:!0,shouldTouch:!0}),n(i)},{searchParams:S,raw:j}=z({pageSize:u,prefix:m}),{products:C,count:p,isPending:v,isError:T,error:_}=M({...S}),g=ee(),R=U(["categories"]),{table:k}=G({data:C,columns:g,getRowId:r=>r.id,count:p,pageSize:u,prefix:m,enableRowSelection:r=>!o.some(i=>i.id===r.original.id),enablePagination:!0,rowSelection:{state:d,updater:P}}),{mutateAsync:E,isPending:w}=N(c),F=s.handleSubmit(async r=>{await E({add:r.product_ids},{onSuccess:()=>{h.success(e("categories.products.add.successToast",{count:r.product_ids.length-o.length})),a()},onError:i=>{h.error(i.message)}})});if(T)throw _;return t.jsx(l.Form,{form:s,children:t.jsxs(X,{onSubmit:F,className:"flex h-full flex-col overflow-hidden",children:[t.jsx(l.Header,{children:t.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[s.formState.errors.product_ids&&t.jsx(D,{variant:"error",children:s.formState.errors.product_ids.message}),t.jsx(l.Close,{asChild:!0,children:t.jsx(f,{size:"small",variant:"secondary",children:e("actions.cancel")})}),t.jsx(f,{size:"small",type:"submit",isLoading:w,children:e("actions.save")})]})}),t.jsx(l.Body,{className:"size-full overflow-hidden",children:t.jsx(Q,{table:k,columns:g,pageSize:u,count:p,queryObject:j,filters:R,orderBy:[{key:"title",label:e("fields.title")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],prefix:m,isLoading:v,layout:"fill",pagination:!0,search:"autofocus"})})]})})},Y=$(),ee=()=>{const{t:c}=x(),o=I();return b.useMemo(()=>[Y.display({id:"select",header:({table:e})=>t.jsx(y,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:a=>e.toggleAllPageRowsSelected(!!a)}),cell:({row:e})=>{const a=!e.getCanSelect(),d=e.getIsSelected()||a,n=t.jsx(y,{checked:d,disabled:a,onCheckedChange:s=>e.toggleSelected(!!s),onClick:s=>{s.stopPropagation()}});return a?t.jsx(O,{content:c("categories.products.add.disabledTooltip"),side:"right",children:n}):n}}),...o],[c,o])},Fe=()=>{const{id:c}=A(),{product_category:o,isPending:e,isFetching:a,isError:d,error:n}=B(c,{fields:"products.id"}),s=!e&&!a&&!!o;if(d)throw n;return t.jsx(l,{children:s&&t.jsx(W,{categoryId:o.id,products:o.products})})};export{Fe as Component};
